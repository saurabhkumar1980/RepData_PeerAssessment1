---
Title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---
## Loading and preprocessing the data
Download and unzip file
```{r, echo=TRUE}
    library(dplyr)
    #URL <- "http://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
    #download.file(URL,destfile="activity.zip")
    #unzip("activity.zip")
```
Read file using read.csv() into a dataframe and see dataframe summary
```{r, echo=TRUE}
    activity <- read.csv("activity.csv")
    summary(activity)
```
## What is mean total number of steps taken per day?
Calculate total number of steps per day using dplyr package. Remove NAs to avoid summarizing to NA
```{r, echo=TRUE,fig.height=6,fig.width=6}
    total_steps_per_day <- activity %>%
                              group_by(date) %>%
                                  summarize(total=sum(steps))
    hist(total_steps_per_day$total,xlab="Total Number of Steps Each Day", main="Histogram - Total Number of Steps Per Day",col="cyan")
    mean_original <- mean(total_steps_per_day$total)  
    median_original <- median(total_steps_per_day$total)  
```
Mean of Total Number of Steps Per Day : `r mean_original`  
Median of Total Number of Steps Per Day : `r median_original`    

## What is the average daily activity pattern?
Caluclate mean/average for each interval using summarize function. 
```{r, echo=TRUE}
    average_steps <- activity[!is.na(activity$steps),] %>%
                          group_by(interval) %>%
                                summarize(average=mean(steps))
    max_average <- max(average_steps$average)
    interval_max_average <- average_steps[average_steps$average==max_average,1]
    plot(average_steps$interval,average_steps$average,type = "l",ylab="Average Steps", xlab= "Interval",main = "Average Steps per Interval", col="cyan")
    points(interval_max_average,max_average,col="red")
#
```
Interval `r interval_max_average` has the maximum avarage of `r max_average`. Plotted using a red point.  

## Imputing missing values. Calculate missing values  
Number of Rows with missing values = `r sum(!complete.cases(activity))`  
Replace missing values with mean/average for that interval. 
```{r, echo=TRUE}
    for (int in unique(activity[,3]))
    {
        activity[is.na(activity$steps) & activity$interval==int,1] <-  average_steps[average_steps$interval==int,1]   
    }
```
Number of Rows with missing values after replacement = `r sum(!complete.cases(activity))`  

```{r, echo=TRUE,fig.height=6,fig.width=6}
    total_steps_per_day_wo_NA <- activity %>%
                                      group_by(date) %>%
                                          summarize(total=sum(steps))
    hist(total_steps_per_day_wo_NA$total,xlab="Total Number of Steps Each Day", main="Histogram - Total Number of Steps Per Day",col="cyan")
    mean_wo_NA <- mean(total_steps_per_day_wo_NA$total)
    median_wo_NA <- median(total_steps_per_day_wo_NA$total)
```
Mean of Total Number of Steps Per Day with NA replaced : `r mean_wo_NA`  
Median of Total Number of Steps Per Day with NA replaced : `r median_wo_NA`    

## Are there differences in activity patterns between weekdays and weekends?
```{r}
    library(lubridate)
    library(ggplot2)
    activity$weekday_end <-ifelse(weekdays(ymd(activity$date)) %in% c("Saturday","Sunday"),"weekend","weekday")
    average_steps <- activity %>%
                        group_by(weekday_end,interval) %>%
                            summarize(average=mean(steps))
    g <- ggplot(average_steps, aes(interval,average))
    g <- g + geom_line(col="blue") + facet_grid(weekday_end ~ .)
    g <- g + labs(x="Interval", y="Number of Steps")
    print(g)
```
